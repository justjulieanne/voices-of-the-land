<!doctype html><html><head>
  <meta charset="utf-8" />
  <title>Voices of the Land — Submit (Cree)</title>
  <meta name="viewport" content="width=device-width,initial-scale:1" />
  <style>
    :root{--bg:#f5efe6; --card:#fff9f2; --accent:#8a4b2a; --accent-2:#b33a2a; --muted:#6b5847;}
    body{font-family:Inter, Arial, sans-serif;background:var(--bg);color:var(--muted);padding:22px;margin:0;}
    .wrap{max-width:720px;margin:0 auto;background:var(--card);padding:20px;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.06);}
    h1{color:var(--accent);margin:0 0 6px;font-size:20px}
    label{display:block;margin-top:12px;font-weight:600}
    input[type=text], textarea, select {width:100%;padding:10px;border:1px solid #e6dcd1;border-radius:8px;margin-top:6px;box-sizing:border-box;}
    .controls{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
    button{background:var(--accent);color:white;border:none;padding:10px 12px;border-radius:8px;cursor:pointer}
    button.secondary{background:transparent;color:var(--accent);border:1px solid var(--accent)}
    button:disabled{background-color:#ccc;cursor:not-allowed;}
    .muted{color:#7a6a5f;font-size:13px}
    .consent{margin-top:10px;display:flex;align-items:center;gap:8px}
    .result{margin-top:12px;font-weight:600;padding:10px;border-radius:8px;display:none;}
    .result.error{color:#721c24;background-color:#f8d7da;border:1px solid #f5c6cb;display:block;}
    .result.success{color:#155724;background-color:#d4edda;border:1px solid #c3e6cb;display:block;}
    .result.pending{color:#0c5460;background-color:#d1ecf1;border:1px solid #bee5eb;display:block;}
    
    .main-nav{background-color:var(--accent);border-radius:8px;margin-bottom:20px;overflow:hidden;}
    .main-nav ul{list-style:none;margin:0;padding:0;display:flex;flex-wrap:wrap;justify-content:center;}
    .main-nav a{display:block;padding:12px 18px;text-decoration:none;color:white;font-weight:600;font-size:15px;}
    .main-nav a:hover{background-color:var(--accent-2);}
  </style>
</head>
<body>
  <div class="wrap">
    <nav class="main-nav">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="submit.html">Submit a Word</a></li>
        <li><a href="dictionary.html">Public Dictionary</a></li>
        <li><a href="admin.html">Admin Review</a></li>
      </ul>
    </nav>
    
    <h1>Submit a Word (Cree)</h1>
    <p class="muted">Share a word or phrase. Submissions will be reviewed by community Elders before being published.</p>

    <label>Community
      <select id="community" aria-label="community">
        <option value="Cree">Cree</option>
      </select>
    </label>

    <label>Submitter name (optional)
      <input id="submitter" type="text" placeholder="Your name (or leave blank for anonymous)" />
    </label>

    <label>Indigenous text (Roman)
      <input id="indigenousText" type="text" placeholder="e.g., Kîsik" />
    </label>
    
    <label>Syllabics (ᓀᐦᐃᔭᐍᐏᐣ)
      <input id="syllabics" type="text" placeholder="e.g., ᑮᓯᐠ" />
    </label>

    <label>English translation
      <input id="englishText" type="text" placeholder="e.g., Sky" />
    </label>

    <label>French translation
      <input id="frenchText" type="text" placeholder="e.g., Ciel" />
    </label>

    <label>Pronunciation / Sounds Like
      <input id="pronunciation" type="text" placeholder="e.g., Kee-sik (optional notes)" />
    </label>

    <div style="margin-top:12px;">
      <p class="muted">Record audio (Feature pending)</p>
      <div class="controls">
        <button id="startBtn" disabled>Start Recording</button>
        <button id="stopBtn" disabled>Stop</button>
      </div>
    </div>
    
    <div class="consent">
      <input type="checkbox" id="consent" />
      <label for="consent">I confirm I have permission to share this word, and understand it may be made public after Elder verification.</label>
    </div>

    <div style="margin-top:14px;">
      <button id="submitBtn">Submit</button>
      <button id="clearBtn" class="secondary">Clear</button>
    </div>

    <div id="result" class="result"></div>
  </div>

  <script>
    // --- THIS IS YOUR WORKING LINK ---
    // You must use the link from your most recent, successful deployment
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbw27lNpaPmfAktNrBl3eZgQ-xA2xDkMhiC7-_KCfk9RLKdxAE_y_BBFP-ulPC3oO1zHpg/exec";
    // --- END LINK ---
    
    const submitBtn = document.getElementById('submitBtn');
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const resultEl = document.getElementById('result'); 

    // Handle disabled audio buttons
    function showDisabledMessage() {
        showMessage('pending', "The audio recording feature is currently disabled. We hope to enable this with future funding.");
    }
    startBtn.onclick = showDisabledMessage;
    stopBtn.onclick = showDisabledMessage;

    // Helper to show messages
    function showMessage(type, message) {
        resultEl.textContent = message;
        resultEl.className = `result ${type}`;
    }
    
    document.getElementById('clearBtn').onclick = () => {
      document.getElementById('submitter').value = "";
      document.getElementById('indigenousText').value = "";
      document.getElementById('syllabics').value = "";
      document.getElementById('englishText').value = "";
      document.getElementById('frenchText').value = ""; 
      document.getElementById('pronunciation').value = "";
      document.getElementById('consent').checked = false;
      showMessage("", ""); // Clear message
    };

    submitBtn.onclick = async () => {
      const submitter = document.getElementById('submitter').value.trim();
      const community = document.getElementById('community').value;
      const indigenousText = document.getElementById('indigenousText').value.trim();
      const syllabics = document.getElementById('syllabics').value.trim();
      const englishText = document.getElementById('englishText').value.trim();
      const frenchText = document.getElementById('frenchText').value.trim(); 
      const pronunciation = document.getElementById('pronunciation').value.trim();
      const consent = document.getElementById('consent').checked;

      if (!indigenousText || !englishText) {
        showMessage('error', "Error: Please provide at least Indigenous text and English translation.");
        return;
      }
      if (!consent) {
        showMessage('error', "Error: Please check the consent box before submitting.");
        return;
      }

      // Audio is disabled, so we send null values
      const audioBase64 = null;
      const audioMime = null;

      const payload = {
        action: "submit",
        community,
        submitter,
        indigenousText,
        syllabics,
        englishText,
        frenchText, 
        pronunciation,
        consent: consent,
        audioBase64, // will be null
        audioMime: audioMime // will be null
      };

      submitBtn.disabled = true;
      showMessage('pending', "Submitting...");
      
      try {
        const resp = await fetch(WEB_APP_URL, {
          method: "POST",
          headers: {"Content-Type":"text/plain;charset=utf-8"}, // Use text/plain to avoid CORS preflight issues
          body: JSON.stringify(payload)
        });
        
        if (!resp.ok) {
            throw new Error(`HTTP error! Status: ${resp.status}`);
        }
        
        const j = await resp.json();
        
        if (j.success) {
          showMessage('success', "Submitted — thank you. It will be verified by Elders before publication.");
          document.getElementById('clearBtn').click();
        } else {
          showMessage('error', "Error: " + (j.message || JSON.stringify(j)));
        }
      } catch (err) {
        console.error("Fetch Error:", err);
        showMessage('error', `Submission failed. Please check your internet connection. (Error: ${err.message})`);
      } finally {
        submitBtn.disabled = false;
      }
    };
  </script>
</body>
</html>
